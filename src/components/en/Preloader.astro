---
// src/components/Preloader.astro
---
<div id="preloader" class="fixed inset-0 z-[100] flex flex-col items-center justify-center bg-[var(--color-noir)]">
  <div class="relative w-24 h-40 mb-8">
    <!-- Simplified Tower Logo SVG -->
    <svg viewBox="0 0 100 160" fill="none" class="w-full h-full">
      <path id="tower-path" d="M30 140 L30 40 L50 20 L70 40 L70 140 Z M20 140 L80 140" 
            stroke="var(--color-gold)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="stroke-dasharray-1000 stroke-dashoffset-1000" />
      <circle id="tower-top" cx="50" cy="10" r="4" fill="var(--color-gold)" class="opacity-0" />
    </svg>
  </div>
  
  <div class="overflow-hidden h-16">
    <h1 id="preloader-title" class="font-display text-4xl md:text-5xl tracking-widest text-[var(--color-ivory)] uppercase translate-y-full opacity-0">
      Caveduke
    </h1>
  </div>
  
  <p id="preloader-est" class="font-accent text-sm text-[var(--color-gold)] mt-4 tracking-[0.25em] opacity-0">
    EST. 1985
  </p>
</div>

<style>
  .stroke-dasharray-1000 {
    stroke-dasharray: 1000;
  }
  .stroke-dashoffset-1000 {
    stroke-dashoffset: 1000;
  }
</style>

<script>
  import { gsap } from 'gsap';

  window.addEventListener('load', () => {
    const tl = gsap.timeline();

    tl.to('#tower-path', {
      strokeDashoffset: 0,
      duration: 1.5,
      ease: 'power2.inOut'
    })
    .to('#tower-top', {
      opacity: 1,
      duration: 0.4,
    }, '-=0.5')
    .to('#preloader-title', {
      y: 0,
      opacity: 1,
      duration: 0.8,
      ease: 'power3.out'
    }, '-=0.4')
    .to('#preloader-est', {
      opacity: 1,
      duration: 0.6,
      ease: 'power2.out'
    }, '-=0.2')
    .to('#preloader', {
      yPercent: -100,
      duration: 1,
      ease: 'power4.inOut',
      delay: 0.4
    });
  });
</script>
